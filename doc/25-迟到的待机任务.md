# 迟到的待机任务

​	我们的系统一直处于没事做就死循环的状态下，那么问题来了？我们在刚开始学编程的时候就明白了一个道理：死循环不要轻易使用。

​	为什么呢？原因其实很简单，死循环如果没有结束条件，那么这个死循环在执行期间就会一直 jmp 循环开始处，jmp 指令耗不耗费 CPU 资源？是的，jmp 指令跟 mov 这些指令一样，都是要耗费系统资源的，而大家都知道 CPU 的执行速度特别特别特别快，死循环一秒，你能想象 CPU 在这一秒内 jmp 了多少次，浪费了多少电吗？

​	所以我们为了节约电费，同时让 CPU 可以降降温，我们马上来编写一个待机任务，用于 CPU 没事的时候进入待机状态，安静的等待新的工作。

​	我们马上编写该待机任务。







































## 提权思路

​	我们在以前都知道，通过软件中断可以让任一特权级的代码陷入到内核级中，所以我们的提权思路就是提供一个提权中断给任务级别，当任务调用该中断，就可以陷入内核级了！

​	同时，我们需要提供一个保存提权例程的地方，这样提权调用才能知道执行哪个提权的例程，我们在 global.h 中加入一个 level0_func 函数地址变量，用于保存这个提权函数，当有了这个变量，我们马上来编写提权调用吧！

## 总结

​	现在我们的系统不会再耗费大量的系统资源了，就算安装在自己的硬件上，它也会安静的运行，如果你的是笔记本就不会听到那因为 CPU 满负载而发出的巨大风扇呼呼声了。

​	同时我们有了任务提权例程，以后任务需要使用到内核级别的机器指令时，就 level0 一下就 OK 啦！







